# Assembly

๐งฉ ะะตะบะปะฐัะฐัะธะฒะฝัะน ะดะฒะธะถะพะบ ะผะฝะพะณะพััะพะฒะฝะตะฒะพะน ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะดะปั ะฟะพัััะพะตะฝะธั ะธะตัะฐััะธัะตัะบะธั ัะธััะตะผ ะธะท ะดะฒะธะถะบะพะฒ ะธ ะปะพะณะธัะตัะบะธั ะตะดะธะฝะธั.

> ะะพะทะฒะพะปัะตั ะพะฟะธััะฒะฐัั ัะปะพะถะฝัั ะธะฝะธัะธะฐะปะธะทะฐัะธั ัะธััะตะผั **ะฟะพ ััะพะฒะฝัะผ**, ะธัะฟะพะปัะทัั ะฟัะฐะฒะธะปะฐ ัะฑะพัะบะธ, ะฟััะธ ะธ ะบะพะฝัะตะบััั.  
> ะะพะดัะพะดะธั ะดะปั ะฟะพัััะพะตะฝะธั ะฟัะพัะพะบะพะปะพะฒ, ะดะฒะธะถะบะพะฒ, ััะตะนะผะฒะพัะบะพะฒ ะธ DSL, ะณะดะต ะฒะฐะถะตะฝ ะฟะพััะดะพะบ, ะฒะปะพะถะตะฝะฝะพััั ะธ ะบะพะฝัะตะบัั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ.

---

## โจ ะะดะตั

`Assembly` โ ััะพ **ะธะฝะธัะธะฐะปะธะทะฐัะธะพะฝะฝัะน ะบะพะฝะฒะตะนะตั**, ะบะพัะพััะน:
- ะกะพะฑะธัะฐะตั ัะธััะตะผั **ะฟะพ ััะพะฒะฝัะผ**
- ะะตัะตะดะฐัั ะบะพะฝัะตะบัั ะพั ัะพะดะธัะตะปั ะบ ะฟะพัะพะผะบั
- ะัะฟะพะปัะทัะตั ะฟัะฐะฒะธะปะฐ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ (`rules`)
- ะะฒัะพะผะฐัะธัะตัะบะธ ัะฐะทัะตัะฐะตั ะฟััะธ ะผะพะดัะปะตะน
- ะะพะดะดะตัะถะธะฒะฐะตั ะฒะปะพะถะตะฝะฝัะต ะพะฑะปะฐััะธ ะธ ะปะพะณะธัะตัะบะธะต ะตะดะธะฝะธัั

ะัะพัะต ะณะพะฒะพัั:

**ะั ะพะฟะธััะฒะฐะตัะต ััััะบัััั โ Assembly ัะพะฑะธัะฐะตั ะตั.**

---

## โ๏ธ ะฃััะฐะฝะพะฒะบะฐ

```bash
npm install c9js/assembly
```

---

## ๐ง ะัะฝะพะฒะฝัะต ะฟะพะฝััะธั

| ะขะตัะผะธะฝ                         | ะะฟะธัะฐะฝะธะต                                                 |
| ------------------------------ | -------------------------------------------------------- |
| **ะฃัะพะฒะตะฝั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ**      | ะจะฐะณ ัะฑะพัะบะธ ัะธััะตะผั (ะดะฒะธะถะบะธ โ ะปะพะณะธะบะฐ โ ะบะพะผะฟะพะฝะตะฝัั ะธ ั.ะด.) |
| **Rule (ะฟัะฐะฒะธะปะพ)**             | ะะฟะธััะฒะฐะตั, ะบะฐะบ ะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐัั ะธ ัะตะณะธัััะธัะพะฒะฐัั ััะพะฒะตะฝั |
| **Engine (ะดะฒะธะถะพะบ)**            | ะัะฝะพะฒะฝะพะน ัะปะตะผะตะฝั ััะพะฒะฝั                                  |
| **Logic (ะปะพะณะธัะตัะบะฐั ะตะดะธะฝะธัะฐ)** | ะะปะพะถะตะฝะฝัะน ัะปะตะผะตะฝั ะฒะฝัััะธ ะดะฒะธะถะบะฐ                          |
| **Parent**                     | ะะพะดะธัะตะปั ัะตะบััะตะณะพ ััะพะฒะฝั                                 |
| **Next**                       | ะะตัะตัะพะด ะบ ัะปะตะดัััะตะผั ััะพะฒะฝั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ                |

---

## ๐ฅ ะัััััะน ััะฐัั

### ะะฝะธัะธะฐะปะธะทะฐัะธั Assembly

```js
const Assembly = require('assembly');

const Assembler = Assembly(
    require('./rules/engines'),    // ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะดะฒะธะถะบะพะฒ
    require('./rules/logic'),      // ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะปะพะณะธัะตัะบะธั ะตะดะธะฝะธั
    require('./rules/components'), // ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะบะพะผะฟะพะฝะตะฝัะพะฒ
);
```

---

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะปะฐััะต

```js
class Protocol {
    constructor() {
        Assembler.engines(this, [
            'flow',
            'state',
            'crypto',
        ]);
    }
}

const protocol = new Protocol();
```

---

## ๐งฉ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

Assembly ัััะพะธั ัะธััะตะผั **ัะฒะตััั ะฒะฝะธะท**:

1. ะัะฑะธัะฐะตััั ะพะฑะปะฐััั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ (`scope`)
2. ะะฐะณััะถะฐัััั ะดะฒะธะถะบะธ
3. ะะปั ะบะฐะถะดะพะณะพ ะดะฒะธะถะบะฐ:
    - ะฟัะธะผะตะฝัะตััั ะฟัะฐะฒะธะปะพ ัะตะบััะตะณะพ ััะพะฒะฝั
    - ัะพัะผะธััะตััั ะบะพะฝัะตะบัั
    - ะฒัะฟะพะปะฝัะตััั ะฟะตัะตัะพะด ะฝะฐ ัะปะตะดัััะธะน ััะพะฒะตะฝั
4. ะะฐะณััะถะฐัััั ะปะพะณะธัะตัะบะธะต ะตะดะธะฝะธัั
5. ะัะพัะตัั ะฟะพะฒัะพััะตััั ัะตะบัััะธะฒะฝะพ

---

## ๐ฆ ะัะฟะพะปัะทะพะฒะฐะฝะธะต Assembly ะฒ ัะตะฐะปัะฝะพะผ ะดะฒะธะถะบะต

Assembly ะธัะฟะพะปัะทัะตััั **ะฒะฝัััะธ ะบะพะฝััััะบัะพัะฐ ะดะฒะธะถะบะฐ** ะบะฐะบ ััะฝะบัะธั ะฟะตัะตัะพะดะฐ ะบ ัะปะตะดัััะตะผั ััะพะฒะฝั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ.

ะะฒะธะถะพะบ **ะฝะต ะทะฝะฐะตั ะพ ัะฐะนะปะพะฒะพะน ััััะบัััะต**,  
ะพะฝ ะปะธัั **ะดะตะบะปะฐัะธััะตั ัะฒะพั ะฒะฝัััะตะฝะฝัั ะบะพะผะฟะพะทะธัะธั**.

---

### ะัะธะผะตั ะดะฒะธะถะบะฐ

```js
module.exports = class FlowEngine {
    constructor(engine) {
    // ะะฝะธัะธะฐะปะธะทะธััะตะผ ะดะฒะธะถะพะบ
        engine(this);
        
    // ะะฝะธัะธะฐะปะธะทะธััะตะผ ัะฟะธัะพะบ ะปะพะณะธัะตัะบะธั ะตะดะธะฝะธั
        engine.logic(
            'incoming', // ะะพะณะธะบะฐ ะพะฑัะฐะฑะพัะบะธ ะฒัะพะดััะธั ะฟะฐะบะตัะพะฒ
            'outgoing', // ะะพะณะธะบะฐ ะพะฑัะฐะฑะพัะบะธ ะธััะพะดััะธั ะฟะฐะบะตัะพะฒ
        );
    }
    
// ะะตัะพะดั ะดะฒะธะถะบะฐ ...
    method1 = () => {}
    method2 = () => {}
    method3 = () => {}
};
```

---

### ะงัะพ ะทะดะตัั ะฟัะพะธััะพะดะธั

- `engine` โ ััะพ **ััะฝะบัะธั ะฟะตัะตัะพะดะฐ Assembly** ะบ ัะปะตะดัััะตะผั ััะพะฒะฝั
- ะัะทะพะฒ `engine(this)`:
    - ะัะธะผะตะฝัะตั `Rule.init`
    - ะะตะณะธัััะธััะตั ะดะฒะธะถะพะบ ัะตัะตะท `Rule.register`
    - ะะพะดะณะพัะฐะฒะปะธะฒะฐะตั ะบะพะฝัะตะบัั ะดะปั ัะปะตะดัััะตะณะพ ััะพะฒะฝั
- ะัะทะพะฒ `engine.logic(...)`:
    - ะะบัะธะฒะธััะตั ัะปะตะดัััะธะน ััะพะฒะตะฝั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ
    - ะะฐะณััะถะฐะตั ะปะพะณะธัะตัะบะธะต ะตะดะธะฝะธัั ะธะท ัะพะพัะฒะตัััะฒัััะตะน ะดะธัะตะบัะพัะธะธ
    - ะะตัะตะดะฐัั ะธะผ ะฝะพะฒัะน ะบะพะฝัะตะบัั

---

### ะะปััะตะฒะฐั ะธะดะตั

ะะฒะธะถะพะบ **ะฝะต ัะฟัะฐะฒะปัะตั ะทะฐะณััะทะบะพะน ะบะพะผะฟะพะฝะตะฝัะพะฒ ะฝะฐะฟััะผัั ะธ ะฝะต ะธะผะฟะพััะธััะตั ัะฒะพะธ ะปะพะณะธัะตัะบะธะต ะตะดะธะฝะธัั ะฒัััะฝัั**.

ะะผะตััะพ ััะพะณะพ ะพะฝ:
- ะะฟะธััะฒะฐะตั **ััััะบัััั**
- ะะฑััะฒะปัะตั **ััะพะฒะฝะธ**
- ะะพะฒะตััะตั Assembly **ัะฑะพัะบั ัะธััะตะผั**

ะคะฐะบัะธัะตัะบะธ:

> **ะะฒะธะถะพะบ โ ััะพ ะดะตะบะปะฐัะฐัะธั.**  
> **Assembly โ ััะพ ะธัะฟะพะปะฝะธัะตะปั.**

---

## ๐ง ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ

ะขะฐะบะพะน ะฟะพะดัะพะด ะฟะพะทะฒะพะปัะตั:
- ะะทะพะปะธัะพะฒะฐัั **ะปะพะณะธัะตัะบะธะต ะตะดะธะฝะธัั ะธ ะบะพะผะฟะพะฝะตะฝัั** ะพั ััััะบัััั ัะฐะนะปะพะฒ
- ะะตะณะบะพ ะดะพะฑะฐะฒะปััั ะฝะพะฒัะต ััะพะฒะฝะธ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ
- ะะฐัะฐะฝัะธัะพะฒะฐัั ะฟะพััะดะพะบ ัะฑะพัะบะธ
- ะกััะพะธัั ะฑะพะปััะธะต ะธะตัะฐััะธัะตัะบะธะต ัะธััะตะผั ะฑะตะท ัะฒัะทะฐะฝะฝะพะณะพ ะบะพะดะฐ
- ะัะฟะพะปัะทะพะฒะฐัั Assembly ะบะฐะบ DSL ะดะปั ะฐััะธัะตะบัััั ัะธััะตะผั

---

## โจ ะะตะทัะปััะฐั

ะัั ัะธััะตะผะฐ ัะพะฑะธัะฐะตััั **ะบะฐะบ ะบะพะฝะฒะตะนะตั**:

```
Protocol
 โโ Engine
    โโ Logic
       โโ Components
```

ะะตะท ัััะฝัั `require`, ะฑะตะท ะถัััะบะธั ัะฒัะทะตะน,
ั ะฟะพะปะฝะพะน ะฟัะพะทัะฐัะฝะพัััั ะฟะพััะดะบะฐ ะธ ะบะพะฝัะตะบััะฐ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ.

---

## ๐ง API

`Assembly(...rules)`

ะกะพะทะดะฐัั ะดะพะผะตะฝะฝัะน ะธะฝะธัะธะฐะปะธะทะฐัะพั.

- `rules` โ ัะฟะธัะพะบ ะฟัะฐะฒะธะป ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะฟะพ ััะพะฒะฝัะผ

ะะพะทะฒัะฐัะฐะตั Proxy-ะพะฑัะตะบั, ัะตัะตะท ะบะพัะพััะน ะฟัะพะธััะพะดะธั ะธะฝะธัะธะฐะปะธะทะฐัะธั.

### ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ (Rule)

ะะฐะถะดะพะต ะฟัะฐะฒะธะปะพ ะดะพะปะถะฝะพ ัะตะฐะปะธะทะพะฒัะฒะฐัั ัะปะตะดัััะธะน ะธะฝัะตััะตะนั:

```js
module.exports = {
    defaultOptions = {}
    path(scopePath, unitPath) {},
    init(parent, current, options) {},
    register(parent, current, scopePath, unitPath) {},
};
```

### ะกะฒะพะนััะฒะฐ:

- `defaultOptions = {}` โ ะะฟัะธะธ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะฟะพ ัะผะพะปัะฐะฝะธั

### ะะตัะพะดั:

- `path(scopePath, unitPath)` โ ะะพะทะฒัะฐัะฐะตั ะฟััั ะบ ะปะพะณะธัะตัะบะพะน ะตะดะธะฝะธัั ะดะปั ะทะฐะณััะทะบะธ
- `init(parent, current, options)` โ ะะฝะธัะธะฐะปะธะทะธััะตั ัะตะบัััั ะปะพะณะธัะตัะบัั ะตะดะธะฝะธัั
- `register(parent, current, scopePath, unitPath)` โ ะะตะณะธัััะธััะตั ะปะพะณะธัะตัะบัั ะตะดะธะฝะธัั ะฒ ัะพะดะธัะตะปััะบะพะผ ะบะพะฝัะตะบััะต

---

### ๐ ะะฐะฝะพะฝะธัะตัะบะธะน ัะฐะฑะปะพะฝ Rule

ะ ัะตะฟะพะทะธัะพัะธะธ Assembly ะพะฟัะตะดะตะปัะฝ **ะพัะธัะธะฐะปัะฝัะน ัะฐะฑะปะพะฝ ะฟัะฐะฒะธะปะฐ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ**,  
ะบะพัะพััะน ะพััะฐะถะฐะตั ะฐััะธัะตะบัััั ะธ ัะธะปะพัะพัะธั ะฟัะพะตะบัะฐ:

๐ **[`/templates/rule.js`](./templates/rule.js)**

ะญัะพั ัะฐะฑะปะพะฝ:

- ะคะธะบัะธััะตั ะฟะพััะดะพะบ `path โ init โ register`
- ะะพะบัะผะตะฝัะธััะตั Rule ะบะฐะบ **ะฐะปะณะพัะธัะผ ัะฑะพัะบะธ**
- ะกะปัะถะธั ะตะดะธะฝัะผ ััะฐะฝะดะฐััะพะผ ะดะปั ะฒัะตั ััะพะฒะฝะตะน ะธะฝะธัะธะฐะปะธะทะฐัะธะธ
- ะะตะบะพะผะตะฝะดัะตััั ะบะฐะบ ะพัะฝะพะฒะฐ ะดะปั `engines`, `logic`, `components` ะธ ะดััะณะธั ััะพะฒะฝะตะน

ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะฐะฑะปะพะฝะฐ ะฟะพะทะฒะพะปัะตั ัะพััะฐะฝััั:
- ะะดะธะฝัะน ััะธะปั ะบะพะดะฐ
- ะงะธัะฐะตะผะพััั Rule-ัะฐะนะปะพะฒ
- ะัะตะดัะบะฐะทัะตะผะพััั ะฟะพะฒะตะดะตะฝะธั Assembly

---

## ๐ง ะคะธะปะพัะพัะธั Rule: ะฟะพััะดะพะบ ะธะผะตะตั ะทะฝะฐัะตะฝะธะต

ะ `Assembly` ะฟัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ (**Rule**) ัะฐััะผะฐััะธะฒะฐะตััั ะฝะต ะบะฐะบ ะฝะฐะฑะพั ะผะตัะพะดะพะฒ,  
ะฐ ะบะฐะบ **ะฐะปะณะพัะธัะผ ะทะฐะณััะทะบะธ ะธ ัะฑะพัะบะธ ัะธััะตะผั**.

Rule ะพัะฒะตัะฐะตั ะฝะฐ ะฒะพะฟัะพัั **ัััะพะณะพ ะฒ ัะปะตะดัััะตะผ ะฟะพััะดะบะต**:

1. **ะะดะต ะปะตะถะธั ะผะพะดัะปั?** โ `path`
2. **ะงัะพ ั ะฝะธะผ ัะดะตะปะฐัั ะฟัะธ ัะพะทะดะฐะฝะธะธ?** โ `init`
3. **ะะฐะบ ะฒัััะพะธัั ะตะณะพ ะฒ ัะธััะตะผั?** โ `register`

ะญัะพ ัะพัะผะธััะตั ะฑะฐะทะพะฒัะน ะบะพะฝะฒะตะนะตั Assembly:

```
path โ init โ register
```

ะคะธะปะพัะพััะบะธ ััะพ ะผะพะถะฝะพ ะฒััะฐะทะธัั ัะฐะบ:

> **ะกะฝะฐัะฐะปะฐ ั ะทะฝะฐั, ััะพ ะทะฐะณััะทะธัั,  
> ะฟะพัะพะผ โ ะบะฐะบ ะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐัั,  
> ะธ ัะพะปัะบะพ ะฟะพัะพะผ โ ะบะฐะบ ะฟะพะดะบะปััะธัั ะบ ัะธััะตะผะต.**

ะะผะตะฝะฝะพ ะฟะพััะพะผั ะฒ Rule ะฟะพััะดะพะบ ะผะตัะพะดะพะฒ ะธะผะตะตั ะทะฝะฐัะตะฝะธะต ะธ ะพััะฐะถะฐะตั ัะตะฐะปัะฝัะน ะฟัะพัะตัั
ัะฐะฑะพัั Assembly โ ะพั ัะฐะทัะตัะตะฝะธั ะฟััะตะน ะธ ะทะฐะณััะทะบะธ ะผะพะดัะปะตะน ะดะพ ะธั ัะตะณะธัััะฐัะธะธ
ะฒ ัะพะดะธัะตะปััะบะพะผ ะบะพะฝัะตะบััะต.

---

## ๐ ะัะธะผะตั ััััะบัััั ะฟัะพะตะบัะฐ

```
lib/
โโโ rules/
โ   โโโ engines.js    # ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะดะฒะธะถะบะพะฒ
โ   โโโ logic.js      # ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะปะพะณะธัะตัะบะธั ะตะดะธะฝะธั
โ   โโโ components.js # ะัะฐะฒะธะปะพ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะบะพะผะฟะพะฝะตะฝัะพะฒ
โ
โโโ engines/
โ   โโโ flow/
โ   โ   โโโ flow-engine.js
โ   โ   โโโ logic/
โ   โ       โโโ core.js
โ   โ
โ   โโโ state/
โ       โโโ state-engine.js
โ       โโโ logic/
โ           โโโ state.js
โ
โโโ index.js
```

---

## ๐งฌ ะััะธัะตะบัััะฝัะต ะพัะพะฑะตะฝะฝะพััะธ

- ๐ ะะตะบัััะธะฒะฝัะน ะฟะตัะตัะพะด ะผะตะถะดั ััะพะฒะฝัะผะธ
- ๐ง ะะพะฝัะตะบัั ะฟะตัะตะดะฐัััั ัะฒะฝะพ (`parent`)
- ๐งฉ ะะตะบะปะฐัะฐัะธะฒะฝะพะต ะพะฟะธัะฐะฝะธะต ััััะบัััั
- ๐งญ ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฐะทัะตัะตะฝะธะต ะฟััะตะน
- ๐ช ะงััะบะฐั ะธะตัะฐััะธั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ

---

## ๐งฉ ะะดะต ะพัะพะฑะตะฝะฝะพ ะฟะพะปะตะทะตะฝ Assembly

- ะกะปะพะถะฝัะต ะฟัะพัะพะบะพะปั
- ะะฒะธะถะบะธ ัะพััะพัะฝะธะน
- ะกะตัะตะฒัะต ััะตะบะธ
- ะะพะดัะปัะฝัะต ััะตะนะผะฒะพัะบะธ
- DSL ั ะธะตัะฐััะธัะตัะบะพะน ััััะบัััะพะน
- ะกะธััะตะผั ั ะถัััะบะธะผ ะฟะพััะดะบะพะผ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ

---

## ๐ ะะธัะตะฝะทะธั

MIT License
